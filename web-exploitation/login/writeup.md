## login

difficulty: medium

---

## sol:

i am presented with a login.

first i check if client side checking is used.
this seems to be the case since there is a js code checking password and username and saying if they are right or wrong.
there is also no network activity when sending the request.

the js code is minified which makes it hard to read
throwing it into a beautifier we get this:

~~~js
(async () =>
{
	await new Promise((e => window.addEventListener("load", e))), document.querySelector("form").addEventListener("submit", (e =>
	{
		e.preventDefault();
		const r = {
				u: "input[name=username]",
				p: "input[name=password]"
			},
			t = {};
		for (const e in r) t[e] = btoa(document.querySelector(r[e]).value).replace(/=/g, "");
		return "YWRtaW4" !== t.u ? alert("Incorrect Username") : "cGljb0NURns1M3J2M3JfNTNydjNyXzUzcnYzcl81M3J2M3JfNTNydjNyfQ" !== t.p ? alert("Incorrect Password") : void alert(`Correct Password! Your flag is ${atob(t.p)}.`)
	}))
})();
~~~

the code seems to take in the inputs of username and password, and giving them the variable names r.u and r.p

it then loops through the r and manipulates it to create a variable t

it then compares t.u to a string "YWRtaW4" if they do not match we get a "incorrect username" alert
it then compares t.p to a string "cGljb0NURns1M3J2M3JfNTNydjNyXzUzcnYzcl81M3J2M3JfNTNydjNyfQ"

so the task is to reverse engineer what the line

~~~js
btoa(document.querySelector(r[e]).value).replace(/=/g, "")
~~~

does and therefore what the two strings are.

[btoa](https://developer.mozilla.org/en-US/docs/Web/API/btoa) creates a base64 encodes ascii string from a binary string.

after encoding it to base64 a regex is applied /=g/ which means remove all = signs

base64 decoding YWRtaW4 with an added = we get admin. trying to log in with this we get "wrong password" 

doing the same with the password we get the flag

## learned

the = in base64 is added as a complement to the end to make the string add up to a multiple of three [source](https://stackoverflow.com/questions/6916805/why-does-a-base64-encoded-string-have-an-sign-at-the-end)
